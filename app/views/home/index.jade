extends ../layouts/default

block head_scripts
  script(type='text/javascript').
    function changevid() {
      document.getElementById('vid').innerHTML = '<source src="images/power.mp4" type="video/mp4">';
      document.getElementById('vid').load();
    }

block top_navigation
  nav.main-nav
    ul
      li: a(href='#about') About
      li: a(href='#work') Work
      li: a(href='#services') Services
      li: a(href='#crew') Crew
      li: a(href='#clients') Clients
      li: a(href='#contact') Contact
      li: a(href='#blog') Blog

block body_content
  include blocks/headline
  include blocks/about
  include blocks/work
  include blocks/services
  include blocks/crew
  include blocks/clients
  include blocks/contact
  include blocks/footer
  include blocks/portfolio

block body_scripts
  script.
    var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
  //- script(data-main='scripts/main', src='/scripts/vendor/requirejs/require.js')
  script.
    jQuery(function($){
      if(!navigator.userAgent.match(/(iPhone|iPod|iPad)/i)) {
        $.stellar({
          hideDistantElements: true,
          responsive: true
        });
      }

      

      $("a[href^='#']").click(function(){//$.scrollTo works EXACTLY the same way, but scrolls the whole screen
        $.scrollTo( this.hash, 800, { offset:-150, axis: 'y' });
        return false;
      });

      $('.trigger').on('click', function(){
        var target = $(this).attr('data-target');
        $('.portfolio').addClass('open');

        // if project is not present it, retreive its json an add it to the page
        if ($('#project-' + target).length == 0) {
          $.ajax({ url: '/projects/' + target + '/json' })
          .done(function(project) {
            console.log(project);
          });
        }

        $('#project-' + target).addClass('active');
        $('body').css('overflow', 'hidden');
      });

      $('.close').on('click', function(){
        closePort();
      });


      // Closes portfolio drawer on esc key press
      $(document).keyup(function(e) {
        if (e.keyCode == 27) {
          closePort();
        }
      });


      // Removes classes and allows body to scroll again
      var closePort = function() {
        $('body').css('overflow', 'visible');
        $('.portfolio').removeClass('open');
        $('.project').removeClass('active');      

      }

      //-  Toggles crew member on mobile
      $('.crew-member').on('click', function(){
        $(this).toggleClass('open');
      });

      //- Toggles Mobile Nav
      $('.nav-toggle').on('click', function(){
        $('.main-nav').slideToggle();
      });

      //- Toggles Services 
      $('.services-list li').on('click', function(){
        $(this).children('.service-details').slideToggle();
      });      

    });
